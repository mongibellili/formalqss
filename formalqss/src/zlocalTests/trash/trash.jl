
f1(q)=100.8*(   9.523809523809524e-5 * q[2][1] - q[1][1] * q[2][1] + q[1][1] * ( 1.0 - q[1][1] ) ) 
df1(q)=100.8*(   9.523809523809524e-5 * q[2][2] - (q[1][2] * q[2][1]   +    q[1][1] * q[2][2]) + q[1][2] * ( 1.0 - q[1][1] )+q[1][1]*(-q[1][2]) ) 
ddf1(q)=100.8*(   9.523809523809524e-5 * q[2][3] - (q[1][2]*q[2][2]+q[1][3]*q[2][1]+  q[1][2]*q[2][2]+q[1][1]*q[2][3]) + q[1][3] * ( 1.0 - q[1][1] ) +q[1][2] * (- q[1][1] )  + q[1][2]*(-q[1][2]) +q[1][1]*(-q[1][3])) 

f2(q)=40320.0*( - 9.523809523809524e-5 * q[2][1] - q[1][1] * q[2][1] +  q[3][1] ) 
df2(q)=40320.0*(- 9.523809523809524e-5*q[2][2]-(q[1][2]*q[2][1]+q[1][1]*q[2][2])+q[3][2])
ddf2(q)=40320*(- 9.523809523809524e-5*q[2][3]-(q[1][3]*q[2][1]+q[1][2]*q[2][2]+q[1][2]*q[2][2]+q[1][1]*q[2][3])+q[3][3])
f3(q)=q[1][1]-q[3][1]
df3(q)=q[1][2]-q[3][2]
ddf3(q)=q[1][3]-q[3][3]
function intgr(x,e)
    x[1]=x[1]+e*x[2]+e*e*x[3]/2+e*e*e*x[4]/6
    x[2]=x[2]+e*x[3]+e*e*x[4]/2
    x[3]=x[3]+e*x[4]
   # @show x
end
function intgrq(x,e)
    x[1]=x[1]+e*x[2]+e*e*x[3]/2
    x[2]=x[2]+e*x[3]

   # @show x
end
function updateQ(x,q)
q[1]=x[1];q[2]=x[2];q[3]=x[3];

end
#############################start#################""
x=[[0.9999999975005381, -0.0003844404588681365, -21.616528714575654*2, -255245.4061393641*6],[3.814256703695357e-6, 0.46926407070799725, 11511.429846502817*2, -1.021243315770821e8*6],[0.0, 1.0, -0.5*2, 6*0.16666666666666666]]
q=[[1.0, 0.0,0.0],[3.814256703695357e-6, 0.4289402307079971, 2*7597.313022054603],[1.5453113783401195e-5, 0.9999845467668154, -1.0]]
e=1.9383675881466253e-5
#@show x
intgr(x[2],e)

updateQ(x[2],q[2])

 intgr(x[1],e)
# @show x
intgrq(q[1],e)
#@show q

x[1][2]=f1(q)
x[1][3]=df1(q)
x[1][4]=ddf1(q)
#@show x

intgrq(q[3],e)
x[2][2]=f2(q)
x[2][3]=df2(q)
x[2][4]=ddf2(q)
#= @show x[2][2],x[2][3]/2,x[2][4]/6
@show q =#
elapsed = 3.492535118477109e-5
intgr(x[2],elapsed)
#@show x[2][1],x[2][2],x[2][3]/2,x[2][4]/6
updateQ(x[2],q[2])
#@show q[2][1],q[2][2],q[2][3]/2
intgr(x[1],elapsed)
#@show x[1][1],x[1][2],x[1][3]/2,x[1][4]/6
updateQ(x[2],q[2])
#@show q[1][1],q[1][2],q[1][3]/2

x[1][2]=f1(q)
x[1][3]=df1(q)
x[1][4]=ddf1(q)
#@show x[1][1],x[1][2],x[1][3]/2,x[1][4]/6
intgrq(q[3],elapsed)
x[2][2]=f2(q)
x[2][3]=df2(q)
x[2][4]=ddf2(q)
@show x[2][1],x[2][2],x[2][3]/2,x[2][4]/6
@show q[3][1],q[3][2],q[3][3]/2